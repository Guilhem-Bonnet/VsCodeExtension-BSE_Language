<body>
	<h2>Exploitation du script à partir d'un écran ou d'une fonction spécifique</h2>

	<p>
		Il est possible d'exploiter les scripts à partir du Bureau Belair pour traiter un ensemble d'enregistrements.<br>
		Il est également possible, d'exploiter un script à partir des différents écrans du Portefeuille ou à partir de la fonction 'Gestion / Quittancement / Réception d'un fichier de quittances'.<br>
		Il est intéressant dans ce cas de permettre au script de récupérer des informations en rapport son environnement d'exploitation.
	</p>

	<b>Exemples :</b>
	<div class="bai_exemple">
		<p>
			Quel est le bordereau exploité dans la fonction 'Gestion / Quittancement / Réception d'un fichier de quittances' ?<br>
			Dans quel contrat 'flotte' et sur quelle pièce est on positionné pour intégrer des entrées et sorties de véhicules ?<br>
			Etc...
		</p>

		<div class="panel panel-info">
			<div class="panel-heading">
				<h3 class="panel-title"><code>;INIT;var=?table("champ")</code></h3>
			</div>
			<div class="panel-body">
				<p>
					Affectation de la valeur d'un champ de l'écran en cours dans une variable
				</p>

				<ul>
					<li><b>var</b> : lettre de A à Z permettant de stocker la valeur</li>
					<li><b>?table("champ")</b> : Champ de l'écran en cours don't on souhaite reprendre la valeur</li>
				</ul>
			</div>
		</div>

		<div class="panel panel-info">
			<div class="panel-heading">
				<h3 class="panel-title"><code>VAL("var")</code></h3>
			</div>
			<div class="panel-body">
				<p>
					Récupération de la valeur stockée par INIT
				</p>
			</div>
		</div>

		<b>Exemple 1 :</b>
		<div class="bai_exemple">
			<p>
				Le script est exploité en portefeuille à partir d'un contrat. On a besoin dans le script de savoir sur quel contrat, de quel tiers et s'il s'agit par exemple d'un contrat 'Auto'.
			</p>

			<div class="bai_code">
				<p>
					;INIT;K=?PIEC("b_contrat")<br>
					;INIT;L=?PIEC("b_piece")<br>
					;INIT;M=?CONT("b_ntiers")<br>
					;INIT;N=?PROD("b_branche")
				</p>

				<p>
					ID := VAL("K")    // n. de ce contrat<br>
					IE := VAL("L")     // n. piece de ce contrat<br>
					IT := VAL("M")     // n. de tiers<br>
					IG$ := VAL("N")   // branche
				</p>
			</div>
		</div>

		<b>Exemple 2 :</b>
		<div class="bai_exemple">
			<p>
				Dans la fonction 'Gestion / Quittancement / Réception d'un fichier de quittances', on veut connaître le n° du bordereau en cours.<br>
				Dans ce cas, il n'est pas nécessaire d'utiliser la commande INIT. La commande VAL permet de tester la nature de bordereau.
			</p>

			<div class="bai_code">
				XB := VAL("T") <span class="bai_comment">// si le bordereau en cours est de nature terme, on récupère son n° dans XB</span><br>
				SI XB = 0 ;XB := VAL("C") <span class="bai_comment">// si XB est resté à 0, on regarde si le bordereau en cours est de nature comptant, on récupère son n° dans XB</span><br>
				SI XB = 0 ;XB := VAL("M") <span class="bai_comment">// etc...</span>
			</div>
		</div>

		<p>
			Si le script est exploité par le menu 'Outils/Automate d'import de données', il peut être nommé indifféremment.
		</p>
		<p>
			Si le script est exploité par à partir du Bureau, par le menu 'Bureautique/Automate', son nom doit débuter par BUREAU.
		</p>

		<p>
			Si le script est exploité en Portefeuille, par le menu 'Bureautique/Automate', son nom doit débuter par ECRAN suivi du nom de l'écran à partir duquel il est exploité (TIERS, CONTRAT, QUITTANCE, SINISTRE).<br>
			Par exemple, pour un script exploité à partir d'un contrat, le script doit avoir un nom commençant par ECRAN CONTRAT
		</p>
	
</div>
</body>