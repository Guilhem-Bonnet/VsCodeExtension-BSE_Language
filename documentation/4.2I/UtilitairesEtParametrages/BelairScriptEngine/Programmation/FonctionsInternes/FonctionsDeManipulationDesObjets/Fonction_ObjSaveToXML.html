<body>


<h3>Fonctions de manipulation des objets</h3>

	<!-- Fonction DATEALP -->
	<div class="panel panel-info">
		<div class="panel-heading">
			<h3 class="panel-title"><code>Obj:SaveToXML</code>
		</h3></div>
		<div class="panel-body">
			<p>La fonction enregistre l'objet (simple ou métier) ou le tableau des objets dans le document XML.
			<br>Le document XML doit avoir au moins la balise racine.
			<br>L'objet sera enregistré à l'intérieur de balises courantes.
			<br>
			<br>
			</p><div class="alert alert-warning" role="alert"><p><b>A savoir que :</b>
			<br>
			<br>Le format de XML utilisé pour sérialiser les propriétés d'objets est compatible avec celui de "TA4Params" (voir 
			<a class="doc-link" categories="Utilitaires et paramétrages, BAS Belair Application Server, Développement, Traitements externes" name="Traitements%20externes%20:%20d%C3%A9velopper%20un%20traitement">traitement de BAS</a>).</p></div>
			
			
			<p>
				<b><br>Paramètres d'entrée :</b>
				</p><ul><li>1. Le document XML.</li>
				<li>2. L'objet ou le tableau des objets.</li></ul>
			
			
			<p>
				<b><br>Résultat :</b>
				<br>Aucun.
			</p>
			
			
			<p>
				<b><br>Exemples :</b><br>
				
				<br><b>Objet simple</b>

				</p><pre><code class="c syntaxhl"><span class="CodeRay">local doc, o1
o1 := Obj:New()
o1.PropInt := <span class="integer">12345</span>
o1.PropDate := Now()
o1.PropStr := <span class="string"><span class="delimiter">"</span><span class="content">Hi there!</span><span class="delimiter">"</span></span> 
doc := XML:New()
XML:StartNode(doc, <span class="string"><span class="delimiter">"</span><span class="content">test</span><span class="delimiter">"</span></span>)
Obj:SaveToXML(doc, o1)
XML:EndNode(doc)
Print(XML:PrettyFormat(doc))
</span></code></pre>
				
<p>Résultat :</p>

<pre><code class="xml syntaxhl"><span class="CodeRay"><span class="preprocessor">&lt;?xml version="1.0"?&gt;</span>
<span class="tag">&lt;test&gt;</span>
  <span class="tag">&lt;object</span> <span class="attribute-name">typename</span>=<span class="string"><span class="delimiter">"</span><span class="content">Object</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;param</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">PropDate</span><span class="delimiter">"</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">ptDateTime</span><span class="delimiter">"</span></span> <span class="attribute-name">date_val</span>=<span class="string"><span class="delimiter">"</span><span class="content">2018-08-09T16:30:55.811</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;param</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">PropInt</span><span class="delimiter">"</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">ptInt</span><span class="delimiter">"</span></span> <span class="attribute-name">int_val</span>=<span class="string"><span class="delimiter">"</span><span class="content">12345</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;param</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">PropStr</span><span class="delimiter">"</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">ptString</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>Hi there!<span class="tag">&lt;/param&gt;</span>
  <span class="tag">&lt;/object&gt;</span>
<span class="tag">&lt;/test&gt;</span>
</span></code></pre>
<br>
<br><b>Tableau des objets</b>

<pre><code class="c syntaxhl"><span class="CodeRay">local doc, a1
a1 := Obj:NewArray()
a1[<span class="integer">0</span>] := Obj:New()
a1[<span class="integer">0</span>].PropInt := <span class="integer">123</span>
a1[<span class="integer">0</span>].PropStr := <span class="string"><span class="delimiter">"</span><span class="content">String 1</span><span class="delimiter">"</span></span> 
a1[<span class="integer">1</span>] := Obj:New()
a1[<span class="integer">1</span>].PropInt := <span class="integer">456</span>
a1[<span class="integer">1</span>].PropStr := <span class="string"><span class="delimiter">"</span><span class="content">String 2</span><span class="delimiter">"</span></span> 
doc := XML:New()
XML:StartNode(doc, <span class="string"><span class="delimiter">"</span><span class="content">test</span><span class="delimiter">"</span></span>)
Obj:SaveToXML(doc, a1)
XML:EndNode(doc)
Print(XML:PrettyFormat(doc))
</span></code></pre>

<p>Résultat :</p>

<pre><code class="xml syntaxhl"><span class="CodeRay"><span class="preprocessor">&lt;?xml version="1.0"?&gt;</span>
<span class="tag">&lt;test&gt;</span>
  <span class="tag">&lt;objects&gt;</span>
    <span class="tag">&lt;object</span> <span class="attribute-name">typename</span>=<span class="string"><span class="delimiter">"</span><span class="content">Object</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;param</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">PropInt</span><span class="delimiter">"</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">ptInt</span><span class="delimiter">"</span></span> <span class="attribute-name">int_val</span>=<span class="string"><span class="delimiter">"</span><span class="content">123</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;param</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">PropStr</span><span class="delimiter">"</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">ptString</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>String 1<span class="tag">&lt;/param&gt;</span>
    <span class="tag">&lt;/object&gt;</span>
    <span class="tag">&lt;object</span> <span class="attribute-name">typename</span>=<span class="string"><span class="delimiter">"</span><span class="content">Object</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
      <span class="tag">&lt;param</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">PropInt</span><span class="delimiter">"</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">ptInt</span><span class="delimiter">"</span></span> <span class="attribute-name">int_val</span>=<span class="string"><span class="delimiter">"</span><span class="content">456</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
      <span class="tag">&lt;param</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">PropStr</span><span class="delimiter">"</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">ptString</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>String 2<span class="tag">&lt;/param&gt;</span>
    <span class="tag">&lt;/object&gt;</span>
  <span class="tag">&lt;/objects&gt;</span>
<span class="tag">&lt;/test&gt;</span>
</span></code></pre>
<br>
<br><b>Sérialiser l'objet métier</b>

<pre><code class="c syntaxhl"><span class="CodeRay">local doc, o1
o1 := from Tiers where Numtiers = <span class="integer">1000</span>
doc := XML:New()
XML:StartNode(doc, <span class="string"><span class="delimiter">"</span><span class="content">test</span><span class="delimiter">"</span></span>)
Obj:SaveToXML(doc, o1[<span class="integer">0</span>])
XML:EndNode(doc)
Print(XML:PrettyFormat(doc))
</span></code></pre>

<p>Résultat :</p>

<pre><code class="xml syntaxhl"><span class="CodeRay"><span class="preprocessor">&lt;?xml version="1.0"?&gt;</span>
<span class="tag">&lt;test&gt;</span>
  <span class="tag">&lt;object</span> <span class="attribute-name">typename</span>=<span class="string"><span class="delimiter">"</span><span class="content">Tiers</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;param</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">Adr1</span><span class="delimiter">"</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">ptString</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;param</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">Adr2</span><span class="delimiter">"</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">ptString</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>2, résidence du parc<span class="tag">&lt;/param&gt;</span>
    <span class="tag">&lt;param</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">Adr3</span><span class="delimiter">"</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">ptString</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>immeuble du Plessis B.P. 110<span class="tag">&lt;/param&gt;</span>
    <span class="tag">&lt;param</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">Adrinsee</span><span class="delimiter">"</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">ptBool</span><span class="delimiter">"</span></span> <span class="attribute-name">bool_val</span>=<span class="string"><span class="delimiter">"</span><span class="content">true</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
    <span class="tag">&lt;param</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">Codepays</span><span class="delimiter">"</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">ptString</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>FR<span class="tag">&lt;/param&gt;</span>
    <span class="tag">&lt;param</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">Codp</span><span class="delimiter">"</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">"</span><span class="content">ptString</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>78000<span class="tag">&lt;/param&gt;</span>
...
  <span class="tag">&lt;/object&gt;</span>
<span class="tag">&lt;/test&gt;</span>
</span></code></pre>
				
			
		</div>
	</div>
	<br><br>
</body>